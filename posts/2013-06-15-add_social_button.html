<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="description" content="description of your site">
    <meta name="author" content="author of the site">
    <!-- For mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Tinkerer にソーシャルボタン追加</title>
    <link rel="stylesheet" href="/css/master.css">
    <link media="only screen and (max-device-width: 480px)" rel="stylesheet" href="/css/mobile.css">
    <!--link(rel='stylesheet', href='/bower_components/google-code-prettify/src/prettify.css')-->
    <link rel="stylesheet" href="/bower_components/google-code-prettify/styles/desert.css">
  </head>
  <body>
    <header><a href="/">
        <h1>yukimemi</h1></a>
      <div id="googlesearch"><script>
  (function() {
    var cx = '011218958289840355707:u8gwqtv7xgg';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

      </div>
    </header>
    <div id="posts">
      <h2>Tinkerer にソーシャルボタン追加</h2>
      <!-- ninja social button--><div id="ninja">
  <div class="ninja_onebutton">
    <script type="text/javascript">
//<![CDATA[
    (function(d){
     if(typeof(window.NINJA_CO_JP_ONETAG_BUTTON_0340347566df4b0439d87aa8bd1d7465)=='undefined'){
     document.write("<sc"+"ript type='text\/javascript' src='http:\/\/omt.shinobi.jp\/b\/0340347566df4b0439d87aa8bd1d7465'><\/sc"+"ript>");
     }else{
     window.NINJA_CO_JP_ONETAG_BUTTON_0340347566df4b0439d87aa8bd1d7465.ONETAGButton_Load();}
     })(document);
//]]>
    </script><span class="ninja_onebutton_hidden" style="display:none;"></span><span style="display:none;" class="ninja_onebutton_hidden"></span>
  </div>
</div>

      <!-- twitter follow button--><div id="twitterfollow">
  <a href="https://twitter.com/yukimemi" class="twitter-follow-button" data-show-count="false">Follow @yukimemi</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
</div>

      <p>[2013/06/15]</p><p>今時のブログとしては、ソーシャルボタンは追加したい。</p>
<p>参考になる記事がいっぱいあったので、参考にしてやってみた。</p>
<h3 id="-">事前準備</h3>
<p><em>layout.html</em> というファイルと <em>page.html</em> というファイルを作る。</p>
<p><em>layout.html</em> は全体？ <em>page.html</em>
は記事一つ一つみたいな感じがする。たぶん。</p>
<pre><code>$ vim _templates/layout.html</code></pre>
<p>中身はこんな感じ。</p>
<pre><code class="lang-html">{% extends &quot;!layout.html&quot; %}

{% block extrahead %}
   &lt;!-- ここに html の ヘッダ部分に追加するスクリプトを書く --&gt;
{% endblock %}</code></pre>
<p>ね。簡単でしょ。 1行目で既存の <em>layout.html</em> を継承してる。(たぶん)</p>
<p><em>layout.html</em> では、*extrahead* というブロックを使うことで、既存の
\<head\>タグに追加の情報を出力 することが出来る。</p>
<p>次に <em>page.html</em></p>
<pre><code>$ vim _templates/page.html</code></pre>
<p>中身はこんな感じ。</p>
<pre><code class="lang-html">{% extends &quot;!page.html&quot; %}

{% block body %}
    {{ timestamp(metadata.formatted_date) }}
    {% block buttons %}
      &lt;!-- ここに ソーシャルボタンのコードを追加していく --&gt;
    {% endblock %}
    {{ body }}
    {{ self.buttons() }}
    {{ post_meta(metadata) }}
    {{ comments }}
{% endblock %}</code></pre>
<p>ソーシャルボタンは記事の上と下に表示したいため、下では上の定義を <em>{{
self.buttons() }}</em> という形 で参照している。</p>
<p>これで事前準備は完了。</p>
<h3 id="twitter-">Twitter ボタン</h3>
<p>ボタン作成のコードをググって取得する。</p>
<p>Twitter のボタンは \<head\>部分のスクリプトは必要ないみたいなので、
<em>page.html</em> にコードを記述する。</p>
<pre><code class="lang-html">&lt;!-- Twitter button --&gt;
&lt;a href=&quot;https://twitter.com/share&quot; class=&quot;twitter-share-button&quot; data-lang=&quot;ja&quot;&gt;ツイート&lt;/a&gt;
&lt;script&gt;!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?&#39;http&#39;:&#39;https&#39;;if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+&#39;://platform.twitter.com/widgets.js&#39;;fjs.parentNode.insertBefore(js,fjs);}}(document, &#39;script&#39;, &#39;twitter-wjs&#39;);&lt;/script&gt;</code></pre>
<p>それから、デフォルトでは横幅が広すぎるので <em>css</em> を調整する。
<a href="http://yuyunko.bitbucket.org/blog/html/2013/06/13/change_theme.html">前回</a>
の記事で自分の <em>theme</em> を 作っていたら、それに追記する。</p>
<pre><code>$ vim _themes/mytheme/static/modern5.css_t</code></pre>
<p>追加するcssはこんな感じ。</p>
<pre><code class="lang-css">/* Twitter button */
iframe.twitter-share-button {
    width: 88px!important;
}</code></pre>
<h3 id="hatena-">hatena ボタン</h3>
<p>ボタン作成のコードをググって取得する。</p>
<p>hatena のボタンは
\<head\>部分にも追加のスクリプトがあるみたいなので、まず <em>layout.html</em>
の <em>{% block extrahead %}</em> に追記する。</p>
<pre><code class="lang-html">&lt;!-- for hatena --&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;http://b.st-hatena.com/js/bookmark_button.js&quot; charset=&quot;utf-8&quot; async=&quot;async&quot;&gt;&lt;/script&gt;</code></pre>
<p>次にボタン部分を <em>page.html</em> に追加する。</p>
<pre><code class="lang-html">&lt;!-- Hatena button --&gt;
&lt;a href=&quot;http://b.hatena.ne.jp/entry/http://yuyunko.bitbucket.org/{{ pagename }}{{ file_suffix }}&quot; class=&quot;hatena-bookmark-button&quot; data-hatena-bookmark-title=&quot;{{ title }} - {{ project }}&quot; data-hatena-bookmark-layout=&quot;standard-balloon&quot; title=&quot;このエントリーをはてなブックマークに追加&quot;&gt;&lt;img src=&quot;http://b.st-hatena.com/images/entry-button/button-only.gif&quot; alt=&quot;このエントリーをはてなブックマークに追加&quot; width=&quot;20&quot; height=&quot;20&quot; style=&quot;border: none;&quot; /&gt;&lt;/a&gt;</code></pre>
<p>URLやタイトルをそのページにあったものに変換している。 <em>{{ pagename }}</em>
、 <em>{{ file_suffix }}</em> などは ググればわかる。</p>
<h3 id="google-">google+ ボタン</h3>
<p>ボタン作成のコードをググって取得する。</p>
<p>まず\<head\>部分に追加するスクリプトを <em>layout.html</em> に追記。</p>
<pre><code class="lang-html">&lt;!-- for gogogle + --&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  window.___gcfg = {lang: &#39;ja&#39;};

  (function() {
    var po = document.createElement(&#39;script&#39;); po.type = &#39;text/javascript&#39;; po.async = true;
    po.src = &#39;https://apis.google.com/js/plusone.js&#39;;
    var s = document.getElementsByTagName(&#39;script&#39;)[0]; s.parentNode.insertBefore(po, s);
  })();
&lt;/script&gt;</code></pre>
<p>それから、ボタン部分を <em>page.html</em> に追記。</p>
<pre><code class="lang-html">&lt;!-- Google+ button --&gt;
&lt;div class=&quot;g-plusone&quot; data-size=&quot;medium&quot;&gt;&lt;/div&gt;</code></pre>
<p>Google+ は簡単でいいね。</p>
<h3 id="facebook-">facebook ボタン</h3>
<p>ボタン作成のコードをググって取得する。 これは app id
とか取得しなきゃいけなくてけっこうめんどくさい。</p>
<p>取得したら、\<head\>部分に追加するスクリプトを <em>layout.html</em> に追記。
<em>channelUrl</em>
とかいうのが全然意味わからんかった。誰か知ってる人教えて下さい。</p>
<pre><code class="lang-html">&lt;!-- for facebook --&gt;
&lt;div id=&quot;fb-root&quot;&gt;&lt;/div&gt;
&lt;script&gt;
    window.fbAsyncInit = function() {
        // init the FB JS SDK
        FB.init({
            appId      : &#39;XXXXXXXXXXXXXXX&#39;,                      // App ID from the app dashboard
            channelUrl : &#39;//yuyunko.bitbucket.org/channel.html&#39;, // Channel file for x-domain comms
            status     : true,                                   // Check Facebook Login status
            xfbml      : true                                    // Look for social plugins on the page
        });

        // Additional initialization code such as adding Event Listeners goes here
    };

    (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id; js.async = true;
    js.src = &quot;//connect.facebook.net/ja_JP/all.js#xfbml=1&quot;;
    fjs.parentNode.insertBefore(js, fjs);
    }(document, &#39;script&#39;, &#39;facebook-jssdk&#39;));
&lt;/script&gt;</code></pre>
<p>ちなみに、非同期にすることで早くなるらしい。</p>
<p>次にボタンを配置する。 <em>page.html</em> に追加する。</p>
<pre><code class="lang-html">&lt;!-- facebook button --&gt;
&lt;div class=&quot;fb-like&quot; data-href=&quot;http://yuyunko.bitbucket.org/{{ pagename }}{{ file_suffix }}&quot; data-send=&quot;false&quot; data-layout=&quot;button_count&quot; data-width=&quot;200&quot; data-show-faces=&quot;true&quot;&gt;&lt;/div&gt;</code></pre>
<p>これでおｋ。</p>
<p>全体は以下の通り。</p>
<p><strong>layout.html</strong></p>
<pre><code class="lang-html">{% extends &quot;!layout.html&quot; %}

{% block extrahead %}
    &lt;!-- for hatena --&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;http://b.st-hatena.com/js/bookmark_button.js&quot; charset=&quot;utf-8&quot; async=&quot;async&quot;&gt;&lt;/script&gt;

    &lt;!-- for gogogle + --&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
      window.___gcfg = {lang: &#39;ja&#39;};

      (function() {
        var po = document.createElement(&#39;script&#39;); po.type = &#39;text/javascript&#39;; po.async = true;
        po.src = &#39;https://apis.google.com/js/plusone.js&#39;;
        var s = document.getElementsByTagName(&#39;script&#39;)[0]; s.parentNode.insertBefore(po, s);
      })();
    &lt;/script&gt;

    &lt;!-- for facebook --&gt;
    &lt;div id=&quot;fb-root&quot;&gt;&lt;/div&gt;
    &lt;script&gt;
        window.fbAsyncInit = function() {
            // init the FB JS SDK
            FB.init({
                appId      : &#39;XXXXXXXXXXXXXXX&#39;,                      // App ID from the app dashboard
                channelUrl : &#39;//yuyunko.bitbucket.org/channel.html&#39;, // Channel file for x-domain comms
                status     : true,                                   // Check Facebook Login status
                xfbml      : true                                    // Look for social plugins on the page
            });

            // Additional initialization code such as adding Event Listeners goes here
        };

        (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id; js.async = true;
        js.src = &quot;//connect.facebook.net/ja_JP/all.js#xfbml=1&quot;;
        fjs.parentNode.insertBefore(js, fjs);
        }(document, &#39;script&#39;, &#39;facebook-jssdk&#39;));
    &lt;/script&gt;
{% endblock %}</code></pre>
<p><strong>page.html</strong></p>
<pre><code class="lang-html">{% extends &quot;!page.html&quot; %}

{% block body %}
    {{ timestamp(metadata.formatted_date) }}
    {% block buttons %}
        &lt;!-- facebook button --&gt;
        &lt;div class=&quot;fb-like&quot; data-href=&quot;http://yuyunko.bitbucket.org/{{ pagename }}{{ file_suffix }}&quot; data-send=&quot;false&quot; data-layout=&quot;button_count&quot; data-width=&quot;200&quot; data-show-faces=&quot;true&quot;&gt;&lt;/div&gt;

        &lt;!-- Hatena button --&gt;
        &lt;a href=&quot;http://b.hatena.ne.jp/entry/http://yuyunko.bitbucket.org/{{ pagename }}{{ file_suffix }}&quot; class=&quot;hatena-bookmark-button&quot; data-hatena-bookmark-title=&quot;{{ title }} - {{ project }}&quot; data-hatena-bookmark-layout=&quot;standard-balloon&quot; title=&quot;このエントリーをはてなブックマークに追加&quot;&gt;&lt;img src=&quot;http://b.st-hatena.com/images/entry-button/button-only.gif&quot; alt=&quot;このエントリーをはてなブックマークに追加&quot; width=&quot;20&quot; height=&quot;20&quot; style=&quot;border: none;&quot; /&gt;&lt;/a&gt;

        &lt;!-- Twitter button --&gt;
        &lt;a href=&quot;https://twitter.com/share&quot; class=&quot;twitter-share-button&quot; data-lang=&quot;ja&quot;&gt;ツイート&lt;/a&gt;
        &lt;script&gt;!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?&#39;http&#39;:&#39;https&#39;;if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+&#39;://platform.twitter.com/widgets.js&#39;;fjs.parentNode.insertBefore(js,fjs);}}(document, &#39;script&#39;, &#39;twitter-wjs&#39;);&lt;/script&gt;

        &lt;!-- Google+ button --&gt;
        &lt;div class=&quot;g-plusone&quot; data-size=&quot;medium&quot;&gt;&lt;/div&gt;
    {% endblock %}
    {{ body }}
    {{ self.buttons() }}
    {{ post_meta(metadata) }}
    {{ comments }}
{% endblock %}

{% set script_files = script_files + [&quot;_static/google_analytics.js&quot;] %}</code></pre>
<h4 id="-">参考:</h4>
<p><a href="http://te2uma.com/blog/2013/03/29/tinkerer_with_social_button.html">Tinkererで作ったブログにソーシャルボタンを追加する —
鉄馬の工具箱</a></p>
<p><a href="http://sphinx-users.jp/doc10/templating.html#id2">テンプレート — Sphinx v1.0.6
    documentation</a></p>
<p><a href="http://sphinx-users.jp/doc10/templating.html#id6">テンプレート — Sphinx v1.0.6 documentatio
    2</a></p>
<p><a href="http://happyweblife.main.jp/mtarcive/laboratory/2011/03/xfbmlfacebook.html">XFBML版Facebookの「いいね！」ボタンを設置する。 - The Web
    Laboratory</a></p>
<p><a href="http://iphone-lab.net/archives/253683">たった一言で「いいね！」ボタンが爆速に！全ブロガーに必須の呪文。
    | iPhone 研究室</a></p>

      <div id="back"><a href="/">&laquo; back to index</a></div>
      <hr>
      <!-- Disqus--><div id="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'yukimemi-github'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
   })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

    </div>
  </body>
  <script data-main="/js/main" src="/js/require.js"></script>
  <!-- google analytics--><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
   (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
   m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
   })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-47356782-2', 'yukimemi.github.io');
  ga('send', 'pageview');
</script>

</html>