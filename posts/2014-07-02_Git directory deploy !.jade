---
title: Git directory deploy !
date: 2014/07/02
layout: ../views/_single_post.jade
---

:markdown
  **roots** のデプロイ手順。

  rootsに限らず、静的サイトジェネレーターを使う場合はけっこう使えると思う。

  ### [X1011/git-directory-deploy](https://github.com/X1011/git-directory-deploy) をダウンロード

  ```sh
  $ wget https://github.com/X1011/git-directory-deploy/raw/master/deploy.sh && chmod +x deploy.sh
  ```

  ###  [X1011/git-directory-deploy](https://github.com/X1011/git-directory-deploy) の設定
  以下の部分を必要に応じて書き換え。

  ```sh
  deploy_directory=public
  deploy_branch=master

  #if no user identity is already set in the current git environment, use this:
  default_username=yukimemi
  default_email=yukimemi@gmail.com

  #repository to deploy to. must be readable and writable.
  repo=origin
  ```

  ### 初回一度だけ実行

  ```sh
  $ git --work-tree public checkout --orphan master
  $ git --work-tree public rm -rf "*"
  $ git --work-tree public add --all
  $ git --work-tree public commit -m "initial publish"
  $ git push -f origin public
  $ git symbolic-ref HEAD refs/heads/drafts && git reset --mixed
  ```

  ### デプロイの仕方。
  まずは、 **drafts** ブランチですべてコミットしておく。(未コミットが残っているとエラーになる。)
  あとは、 **roots** でコンパイルしてから、ダウンロードした **deploy.sh** を実行するだけ。

  ```sh
  $ roots compile --no-compress
  $ ./deploy.sh
  ```

  かんたん。

  ---
  #### 参考:

  [X1011/git-directory-deploy](https://github.com/X1011/git-directory-deploy)

// vim: ft=markdown
